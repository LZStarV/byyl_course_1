# 实验一：功能模块设计及实现（算法与核心实现）

## 前言

在每一小节开头，我们会告知读者本功能模块所需要使用到的重要数据结构（与存储结构）的名称、用途及其各个字段的名称、类型以及说明；对于较为复杂的数据结构，笔者将在文中绘制对应的示意图，以便读者方便理解。其中，部分单字段数据结构并没有使用结构体存储，以方便进行访问。

随后，我们将详细阐述功能模块的实现原理、实现细节以及重要的核心代码或片段。对于较为重点的功能，笔者在讲解这一功能实现后，会添加上必要的单元测试，以保证实现的正确性与鲁棒性。

本前言适用于【实验一】与【实验二】两部分：
- 实验一侧重词法：正则与命名解析、AST 构建、Thompson 构造 NFA、子集构造 DFA、Hopcroft 最小化、状态表生成、词法代码生成、组合扫描与编码输出。
- 实验二侧重语法：BNF 文法解析、First/Follow 计算、LR(0)/LR(1) 项集 DFA 构造与分析表生成、SLR(1) 判断、LR(1) 语法分析流程可视化与语法树生成、语法代码导出与验证。

## 图片插入位置与简单描述

为便于后续统一绘制与插入图片，现汇总各模块文档中的图片占位位置与简要说明（占位均已分散插入在对应文档的关联段落处）：

【实验一】
- 01_正则解析与预处理.md：
  - 位置：在“构造 RegexFile：宏进入 rules，Token 进入 tokens”段落之后。
  - 描述：加载正则文件界面图；展示打开 .regex 文件与解析统计信息。
  - 位置：在“算法实现过程”段落之后。
  - 描述：规则文本解析流程图；展示文本→行处理→命名头→宏/Token 集合。
  - 位置：在“算法实现过程”段落关于“预处理”说明之后。
  - 描述：预处理流程图；展示从原始正则文本到字母表的关键步骤与关系。
  - 位置（新增）：在“单元测试”段落之后。
  - 描述：CliRegexTest 运行截图（命令行正则解析与统计）。
- 02_AST 构建（RegexParser）.md：
  - 位置：在“连接与选择”段落之后。
  - 描述：AST 示例图；展示包含连接/选择/后缀运算的一棵典型表达式树。
- 03_Thompson 方法转 NFA.md：
  - 位置：分别在各运算符说明段落中（单字符/ε、连接、选择、闭包、正闭包、可选、字符类）。
  - 描述：对应的 NFA 构造示意图；展示头/尾节点、ε 边与片段拼接方式。
  - 位置（新增）：在“算法实现过程（编号式）”段落之后。
  - 描述：Thompson 构造流程图；展示递归分派与片段组合流程。
  - 位置（新增）：在“单元测试”段落之后。
  - 描述：FACoreTest 运行截图（NFA 结构检查）。
- 04_子集构造算法（NFA→DFA）.md：
  - 位置：在“步骤拆分”之后。
  - 描述：子集构造流程图；展示 ε-闭包、move、集合去重与编号的循环过程。
  - 位置（新增）：在“单元测试”段落之后。
  - 描述：FACoreTest DFA 运行截图（无 ε 转移检查）。
- 05_Hopcroft 最小化算法（DFA→MinDFA）.md：
  - 位置：在“步骤拆分”之后。
  - 描述：Hopcroft 划分示意图；展示初始划分与若干轮细分后的分区对比。
  - 位置（新增）：在“算法实现过程（编号式）”段落之后。
  - 描述：Hopcroft 迭代流程图；展示初始划分→细分→队列推进→收敛→重建。
  - 位置（新增）：在“单元测试”段落之后。
  - 描述：FACoreTest MinDFA 运行截图（起始态断言）。
- 06_词法代码生成（CodeGenerator）.md：
  - 位置：在“AcceptState/Step”说明段落之后。
  - 描述：代码查看页签截图；展示生成的 Step/AcceptState 片段与分发表。
  - 位置（新增）：在“算法实现过程（编号式）”段落之后。
  - 描述：代码生成管线流程图；展示状态遍历→函数生成→分发表→权重与跳过→主程序。
  - 位置（新增）：在“单元测试”段落之后。
  - 描述：CodegenTest 运行截图（编译退出码与运行输出）。
- 07_组合扫描与编码输出（Engine.runMultiple）.md：
  - 位置：在“词素追加与输出”说明段落之后。
  - 描述：测试与验证页签截图；展示输入示例源与输出编码序列（包含追加词素）。
  - 位置（新增）：在“算法实现过程（编号式）”段落之后。
  - 描述：组合扫描流程图；展示跳过策略→遍历 DFA→最长匹配→权重选择→输出与推进。
  - 位置（新增）：在“单元测试”段落之后。
 - 描述：LongestMatchTest / CliRegexTest 运行截图（断言与输出统计）。
的核心函数片段。

【实验二】
- 01_BNF 文法输入与解析（GrammarParser）.md：
  - 位置：在“UI 展示”段落之后。
  - 描述：BNF 文本输入与解析按钮区域截图（文本编辑区、加载与解析）。
  - 单元测试截图：在“单元测试/测试结果”小节后插入 GUI 截图占位。
- 02_FIRST 与 FOLLOW 计算（LL1）.md：
  - 位置：在“UI 展示”段落之后。
  - 描述：FIRST 集表格与 FOLLOW 集表格截图（非终结符×终结符）。
  - 单元测试截图：在“单元测试/测试结果”小节后插入 GUI 截图占位。
- 03_LR(0) 项集 DFA 构造与预览（LR0Builder）.md：
  - 位置：在“状态表可视化与调试”段落处。
  - 描述：LR(0) DFA 预览图（节点标签聚合项；边为符号迁移）。
  - 位置：在“状态表可视化与调试”段落处。
  - 描述：LR(0) 表格视图（状态×项列表、迁移表）。
  - 单元测试截图：在“单元测试/测试结果”小节后插入 GUI 截图占位。
- 04_SLR(1) 判定与原因呈现（SLR）.md：
  - 位置：在“状态表可视化与调试”段落处。
  - 描述：SLR(1) 检查结果弹窗截图（结论与冲突明细）。
  - 单元测试截图：在“单元测试/测试结果”小节后插入 GUI 截图占位。
- 05_LR(1) 项集 DFA 构造与预览（LR1Builder）.md：
  - 位置：在“状态表可视化与调试”段落处。
  - 描述：LR(1) DFA 预览图（节点标签聚合项；边为符号迁移）。
  - 位置：在“状态表可视化与调试”段落处。
  - 描述：LR(1) 表格视图（状态×项列表、迁移表）。
  - 单元测试截图：在“单元测试/测试结果”小节后插入 GUI 截图占位。
- 06_LR(1) 解析表构造与查看（Action/Goto）.md：
  - 位置：在“状态表可视化与调试”段落处。
  - 描述：LR(1) 解析表截图（行=状态、列=符号，动作/转移）。
  - 单元测试截图：在“单元测试/测试结果”小节后插入 GUI 截图占位。
- 07_LR(1) 语法分析过程（逐步表格）.md：
  - 位置：在“状态表可视化与调试”段落处。
  - 描述：解析过程步骤表截图（stack/rest/action/production）。
  - 单元测试截图：在“单元测试/测试结果”小节后插入表格截图占位与语法树预览占位。
- 08_语法树生成与预览（ParseTree/SemanticAST）.md：
  - 位置：在“状态表可视化与调试”段落处。
  - 描述：语法树预览图（Graphviz 渲染 PNG）；语义过程日志片段（移进/归约语义步骤）。
  - 单元测试截图：在“单元测试/测试结果”小节后插入语法树预览与语义日志占位。

## 写作规范与示例风格

- 每一模块采用【数据结构（表格）】+【步骤拆分】+【详细过程讲解】+【各种情况讲解】+【关键代码片段】的结构撰写。
- 代码片段直接粘贴实现的核心片段进行讲解，不包含任何文件路径或行号标注。
- 图片以占位注释标注，并与相邻文字形成紧密关联（示例：在说明段落中加入“下图展示 XXX”，随后跟随占位注释）：
  - `<!--【图片类型】此处需要添加 'XXX 图'：简述... -->`

<!-- 提示：各模块已在相应位置分散插入图片占位注释，请结合文字说明添加对应截图或示意图。 -->
